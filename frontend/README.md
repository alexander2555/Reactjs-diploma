# Result University Diploma Project | CollageWeb

### Сущности

- _Пользователь_ - администратор, мастер, пользователь, гость;
- _Роль_ - роль пользователя, определяющая его права;
- _Документ_ - коллаж, состоящий из графических элементов, имеющий владельца и редактора, может быть публичным;
- _Элемент_ - элемент графики, загружаемый пользователем, может быть публичным или приватным.

### Роли:

- _**Администратор**_: создание/удаление/редактирование пользователей, документов, назначение редакторов, публикация;
- _**Мастер**_: создание/редактирование документов, назначение редакторов собственных документов, публикация документов (public/private), загрузка/редактирование графики;
- _**Клиент**_: редактирование документов с правом на редактирование, просмотр публичных документов, загрузка/редактирование графики;
- _**Гость**_: просмотр публичных документов.

---

### Таблицы БД

| Название      | Поля                                                      | Описание                      |
| ------------- | --------------------------------------------------------- | ----------------------------- |
| **users**     | id, login, password, reg_at, role_id                      | Пользователи                  |
| **roles**     | id, name                                                  | Роли пользователей            |
| **documents** | id, title, created_at, owner_id, editor_id, public, props | Документы (коллажи)           |
| **elements**  | id, title, url, uploaded_at, owner_id, public             | Элементы (графика)            |
| **doc_el**    | id, doc_id, el_id, props                                  | Связь документов с элементами |
| **sessions**  | id, user_id, token, created_at, expires_at                | Сессии пользователей          |

---

### Схемы состояний

_Сервер_:

- сессия польз-ля

_Стор на клиенте_:

- пользователь - user: id, login, role
- документы - document[]: id, title, createdAt, ownerId, editorId, public
- текущий документ - document: id, title, createdAt, ownerId, editorId, public, element[]: id, props
- элементы - graphics[]: id, title, url, uploadedAt, public, ownerId, props - ?
- роли - role[]: id, name

---

### Права на действия с сущностями

| Действие                   | Администратор | Мастер        | Клиент               | Гость     |
| -------------------------- | ------------- | ------------- | -------------------- | --------- |
| Создать пользователя       | ✅            | ❌            | ❌                   | ❌        |
| Редактировать пользователя | ✅            | ❌            | ❌                   | ❌        |
| Удалить пользователя       | ✅            | ❌            | ❌                   | ❌        |
| Создать документ           | ✅            | ✅            | ❌                   | ❌        |
| Редактировать документ     | ✅            | ✅ own        | ✅ permit            | ❌        |
| Удалить документ           | ✅            | ✅ own        | ❌                   | ❌        |
| Публиковать документ       | ✅            | ✅ own        | ❌                   | ❌        |
| Просматривать документ     | ✅            | ✅ own/public | ✅ permit/public     | ✅ public |
| Загрузить элемент          | ✅            | ✅            | ✅                   | ❌        |
| Редактировать элемент      | ✅            | ✅ own        | ✅ own               | ❌        |
| Использовать элемент       | ✅            | ✅ own/public | ✅ own/permit/public | ❌        |
| Удалить элемент            | ✅            | ✅            | ✅ own               | ❌        |

---

© 2025 Alexander Mamontov <alexander2555@yandex.ru>
